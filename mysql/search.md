###查询处理
查询操作在关系数据库中最为频繁的操作，也是构成其他SQL语句（DELET、UPDATE）的基础，当要删除或更新某些记录时，
首先要查询处这些记录。所以查询操作非常重要。
<p>查询处理分为逻辑查询处理和物理查询处理。
<p>逻辑查询处理表示执行查询应该产生什么样的结果，而物理查询处理代表数据库是如何得到这些结果的。

####逻辑查询处理
SQL语言不同与其编程语言的是：在处理代码的顺序上。大多编程语言代码按编码顺序被处理。但在SQL语言中，第一个被处理的是FROM字句。

下列是SQL逻辑查询处理的顺序：

![](https://github.com/damoncs/Damonzh/blob/master/images/SQLSearch.PNG)

11个步骤，最先执行FROM，最后执行LIMIT操作。每个操作都产生一张虚拟表，该表作为一个处理的输入。

>1>FROM：对FROM字句中的左表和右表指向笛卡尔积，产生虚拟表VT1。

>2>ON:对虚拟表VT1应用ON筛选，只有那些符合<join_condition>的行才会被插入VT2。

>3>JOIN：如果指定了OUTER JOIN，那么保留表中未匹配的行作为外部行添加到VT2，产生VT3。而如果FROM字句包含两个以上的表，则对上一个连接生成的结果表VT3和下一个表重复执行步骤1~3，直到处理完毕。

>4>WHERE:对虚拟表VT3应用WHERE过滤条件，符合的记录被插入虚拟表VT4。

>5>GROUP BY：根据GROUP BY字句的列，对VT4中的记录进行分组操作，产生VT5。

>6>CUBE|ROLLUP：对VT5进行CUBE或ROLLUP操作，产生VT6。

>7>HAVING：对VT6应用HAVING过滤器，符合条件的北插入VT7。

>8>SELECT：第二次执行SELECT操作，选择指定的列，插入VT8。

>9>DISTINCT：取出重复数据。

>10>ORDER BY：将虚拟表VT9中的记录按照条件排序。产生VT10。

>11>LIMIT：取出指定行的记录，产生虚拟表VT11并返回给用户。

######1.执行笛卡尔积

######2.应用ON过滤器

SELECT查询一共有3个过滤过程，分别是ON、WHERE、HAVING。

经过笛卡尔积产生的VT1虚拟表，在产生VT2时，会增加一个额外的列来表示ON过滤器的返回值。

返回值有TRUE、FALSE、UNKNOWN。此时，取出比较值为TRUE的记录，产生虚拟表VT2。

######3.添加外部行

这一步在连接类型为OUTER JOIN时发生。如LEFT OUTER JOIN。（大多省略OUTER关键字）

LEFT OUTER JOIN把左表记为保留表，添加外部行的操作就是在VT2的基础上添加保留表中被过滤的数据。

#####7.应用HAVING过滤器
HAVING是对分组条件进行过滤的筛选器。这是最后调用的过滤器。

#####11.LIMIT子句
LIMIT n,m  表示从第n条记录开始选择m条记录。

使用此字句可以解决Web中的分页问题。但对于大规模的数据（例如论坛）LIMIT n,m的效率非常低。

因此，数据量庞大的分页问题，在应用层建立一定的缓存机制很有必要。